import pandas as pd
import os

CSV_PATH = r"C:\Users\harunami\Desktop\helloworld\植栽データ_utf8_bom.csv"
BACKUP_PATH = r"C:\Users\harunami\Desktop\helloworld\植栽データ_utf8_bom.bak.csv"

# Make backup
if not os.path.exists(BACKUP_PATH):
    import shutil
    shutil.copy2(CSV_PATH, BACKUP_PATH)

# Load existing
df = pd.read_csv(CSV_PATH, encoding='utf-8-sig', index_col=0)

# Define new data
# Columns: '科・属名', '常緑/落葉区分', '樹高区分', '樹高', '成長速度区分', '成長速度詳細', '基本的な特徴', '魅力・観賞価値', '花の観賞価値', '花期', '花の特徴', '実の観賞価値、利用価値', '結実期', '実の特徴', '葉の特徴', '幹の特徴', '剪定適期', '剪定を避ける時期', '剪定・仕立て方法', '刈込剪定', '病害虫のつきやすさ', '注意すべき病気・病害虫', '耐寒性', '耐暑性', '耐陰性', '耐乾燥性', 'その他メモ'

new_data = {
    "アガベ": [
        "キジカクシ科・リュウゼツラン属", "常緑", "低木", "0.5m-2m", "遅い", "年数cm程度",
        "肉厚で鋭いトゲを持つ葉がロゼット状に広がる多肉植物。\n乾燥地帯原産で非常に強健。\n数十年かけて一度だけ花を咲かせ、枯れる「センチュリー・プランツ」。\n品種により大きさや葉色が多様。",
        "彫刻のような美しいフォルム。\nドライガーデンやモダンな庭の主役に最適。",
        "観賞価値あり（開花は稀）", "夏（数十年の一度）", "長い花茎を伸ばし、黄色い花を咲かせる。",
        "なし", "秋", "特になし",
        "肉厚で硬く、鋭いトゲがある。\n色は青緑、斑入りなど様々。", "茎は短く、葉に隠れて見えないことが多い。",
        "春・秋", "真夏・真冬", "下葉が枯れたら切り取る程度。\nトゲが危険なため、先端を切ることもある。", "不可",
        "つきにくい", "アザミウマ、カイガラムシ",
        "品種による（強い～やや弱い）", "強い", "弱い（日光を好む）", "強い",
        "品種によって耐寒性が大きく異なるため、選定時に注意が必要。"
    ],
    "ウチワサボテン": [
        "サボテン科・オプンチア属", "常緑", "低木", "1m-2m", "普通程度", "年10-30cm程度",
        "平べったい団扇のような茎節がつながるサボテン。\n暑さ乾燥に強く、強健。\n美しい花や食用になる実をつける品種もある。",
        "ユニークな形状が庭のアクセントになる。\nドライガーデンに最適。",
        "観賞価値が高い", "6月-8月", "黄色や赤、オレンジの鮮やかな花を咲かせる。",
        "利用価値あり", "秋", "赤紫色の実（トゥナ）がなり、食用になる品種もある。",
        "葉は退化してトゲになっている。\n茎節が葉のように見える。", "木質化して茶色くなることがある。",
        "春・秋", "真夏・真冬", "伸びすぎた茎節を節のところで切り取る。\n「胴切り」といわれる。", "不可",
        "つきにくい", "カイガラムシ",
        "やや弱い（0度以上推奨）", "強い", "弱い", "強い",
        "耐寒性は品種による。寒冷地では鉢植え推奨。"
    ],
    "エメラルドグリーン": [
        "ヒノキ科・クロベ属", "常緑", "中木", "3m-5m", "普通程度", "年30cm程度",
        "美しい円錐形にまとまるコニファーの代表種。\nニオイヒバの園芸品種（スマラグ）。\n葉が密生し、目隠しにも適している。",
        "鮮やかな緑色の葉が一年中楽しめる。\n整った樹形が洋風ガーデンに合う。",
        "観賞価値が低い", "4月-5月", "目立たない小さな花。",
        "観賞価値が低い", "10月-11月", "茶色い小さな球果。",
        "光沢のある鮮やかな緑色の鱗葉。\n寒さにあたっても変色しにくい。", "赤褐色の樹皮。",
        "3月-4月、9月-10月", "真夏・真冬", "自然に樹形が整うため、刈り込みは最小限で良い。\n透かし剪定で内部の蒸れを防ぐ。", "可",
        "つきやすい", "ハダニ、カイガラムシ、ミノムシ",
        "強い", "やや弱い（蒸れに注意）", "普通程度", "普通程度",
        "北海道でも植栽可能。夏の蒸れに弱いので風通しを良くする。"
    ],
    "エレガンテシマ": [
        "ヒノキ科・コノテガシワ属", "常緑", "中木", "4m-6m", "普通程度", "年30cm程度",
        "コノテガシワの園芸品種。\n季節によって葉色が変化するのが特徴。\n縦に伸びる円錐形の樹形。",
        "黄金色から赤褐色へ変化する葉色が美しい。\nガーデニングの定番コニファー。",
        "観賞価値が低い", "3月-4月", "目立たない。",
        "観賞価値が低い", "10月", "金平糖のような形の球果。",
        "平たい鱗状の葉。\n春〜夏は黄金色、冬は赤褐色になる。", "赤褐色。",
        "3月、9月-10月", "真夏・真冬", "刈り込みに強い。\n芯を止めて高さを調整する。", "推奨",
        "つきにくい", "ハダニ",
        "強い", "強い", "普通程度", "強い",
        "非常に丈夫で育てやすい。"
    ],
    "コノテガシワ": [
        "ヒノキ科・コノテガシワ属", "常緑", "中木", "5m-10m", "普通程度", "年30cm程度",
        "中国原産の常緑針葉樹。\n葉が子供の手のひらのように垂直に立つのが名前の由来。\n丈夫で公害にも強い。",
        "独特の葉の付き方と丸い樹形。\n和風・洋風問わず使える。",
        "観賞価値が低い", "3月-4月", "目立たない。",
        "観賞価値あり", "10月", "薄青色から褐色に熟す、角のある独特な形の実。",
        "表裏の区別がない平たい葉が垂直に並ぶ。", "灰褐色で縦に裂ける。",
        "3月、6月、9月-10月", "真夏・真冬", "萌芽力が強く刈り込みに耐える。\n内部が蒸れやすいため透かし剪定を行う。", "推奨",
        "つきにくい", "ハダニ",
        "強い", "強い", "普通程度", "強い",
        "実は漢方薬（柏子仁）として使われる。"
    ],
    "ゴールドクレスト": [
        "ヒノキ科・イトスギ属", "常緑", "中木", "5m-10m", "早い", "年50cm-1m程度",
        "明るい黄緑色の葉と、シトラス系の香りが特徴。\nクリスマスツリーとして人気。\n成長が非常に早く、根が浅いため倒れやすい。",
        "輝くような明るい葉色が庭を明るくする。\n香りが良い（サンショウの香り）。",
        "観賞価値が低い", "5月-6月", "目立たない。",
        "観賞価値が低い", "秋", "小さな球果。",
        "柔らかい鱗葉で、春〜秋は鮮やかな黄緑色。\n冬は少しオレンジがかる。", "赤褐色。",
        "3月-6月、9月-10月", "真夏・真冬", "金属のハサミを嫌う（切り口が茶色くなる）ため、手で摘むのが理想。\n刈り込みも可能だが、蒸れに注意。", "可",
        "つきにくい", "ハダニ、枯れ込み病",
        "やや弱い（0度以上推奨）", "弱い（蒸れに弱い）", "普通程度", "やや強い",
        "日本の高温多湿に弱く、大きくなると枯れ込みやすい消耗品的な側面も。"
    ],
    "タラノキ2": [
        "ウコギ科・タラノキ属", "落葉", "低木", "2m-4m", "早い", "年50cm-1m程度",
        "春の山菜「タラの芽」が収穫できる木。\n本来はトゲが多いが、庭木や栽培用にはトゲなし品種（メダラ）が向く。\n日当たりを好み、荒れ地でも育つパイオニア植物。",
        "山菜としての収穫の楽しみ。\n野趣あふれる樹形。",
        "観賞価値あり", "8月", "枝先に小さな白い花が集まって咲く。",
        "観賞価値あり", "10月-11月", "黒く熟す小さな実。",
        "大きな羽状複葉（2回〜3回）。\n長さ1mにもなり、南国風の雰囲気もある。", "トゲがある（メダラは少ない）。\n一本立ちになりやすい。",
        "落葉期（12月-3月）", "芽吹き時（4月-5月）", "収穫後に切り戻すことで高さを抑える。\n「ふかし栽培」用に短く切ることもある。", "不可",
        "普通程度", "カミキリムシ、アブラムシ",
        "強い", "強い", "普通程度", "強い",
        "地下茎で増えすぎるため、根域制限が必要な場合がある。"
    ],
    "ダジリリオン": [
        "キジカクシ科・ダシリリオン属", "常緑", "低木", "1m-2m", "非常に遅い", "年数cm程度",
        "メキシコ原産の乾燥地帯の植物。\n細長い葉が放射状に広がり、成長すると太い幹ができる。\n非常に強健で、ドライガーデンの主役になる。",
        "トゲのある幾何学的な葉の広がりが美しい。\nワイルドで彫刻的な存在感。",
        "観賞価値が高い", "数年に一度", "非常に長い花茎を伸ばし、クリーム色の花を咲かせる。",
        "なし", "-", "特になし",
        "硬く細長い葉で、縁に鋭いトゲがある（品種による）。\n先端が筆のようにばらける。", "太くゴツゴツしており、古くなると黒ずむ。",
        "春・秋", "真夏・真冬", "下葉が枯れたら根元から切り取る。\n丸く整えるようにカットすることもある。", "不可",
        "つきにくい", "特になし",
        "強い（-10度程度）", "強い", "普通程度", "強い",
        "成長が非常に遅いため、完成形の株を購入するのが一般的。"
    ],
    "ニオイヒバ2": [
        "ヒノキ科・クロベ属", "常緑", "高木", "10m-20m", "普通程度", "年30cm程度",
        "北米原産の常緑針葉樹。\n葉を揉むと甘い パイナップルや柑橘のような香りがする。\n寒さに非常に強く、北海道でも生垣に使われる。",
        "美しい円錐形の樹形と、一年中緑を保つ葉。\n香りの良さ。",
        "観賞価値が低い", "4月-5月", "目立たない。",
        "観賞価値が低い", "10月", "小さな球果。",
        "鱗状の葉が平面的に広がる。\n表は濃い緑、裏は黄緑。", "赤褐色で縦に剥がれる。",
        "3月、6月、9月", "真夏・真冬", "刈り込みに強く、生垣に仕立てやすい。\n芯を止めて高さを管理する。", "推奨",
        "つきにくい", "ハダニ、ミノムシ",
        "非常に強い", "やや弱い（蒸れに注意）", "普通程度", "普通程度",
        "水はけのよい場所を好む。"
    ],
    "ニューサイラン": [
        "ススキノキ科（ワスレグサ科）・フォルミウム属", "常緑", "多年草（低木扱い）", "1m-3m", "普通程度", "年20-30cm程度",
        "ニュージーランド原産の多年草（庭木として扱われることが多い）。\n剣のような長い葉が株元から扇状に広がる。\nカラーリーフとして非常に人気。",
        "スタイリッシュでモダンな葉姿。\n赤、銅、斑入りなど葉色が豊富。",
        "観賞価値あり", "夏（稀）", "長い茎を伸ばし、赤や黄色の花を咲かせるが、日本では稀。",
        "なし", "-", "特になし",
        "硬く長い剣状の葉。\n繊維が強く丈夫。", "茎はなく、根元から葉が出る。",
        "春・秋", "真夏・真冬", "古くなって傷んだ外側の葉を根元から切り取る。\n株分けで増やす。", "不可",
        "つきにくい", "特になし",
        "普通程度（-5度程度）", "強い", "普通程度", "強い",
        "寒冷地では冬に防寒が必要。品種により耐寒性が異なる。"
    ],
    "ハシラサボテン": [
        "サボテン科・柱サボテン類", "常緑", "低木", "1m-5m", "普通程度", "年10-30cm程度",
        "柱状に上に伸びるサボテンの総称（鬼面角など）。\nトゲが少なく、シンプルなフォルムが人気。\n乾燥に強く、手間がかからない。",
        "垂直に伸びるラインが建築的で美しい。\nモダンな庭やドライガーデンに合う。",
        "観賞価値が高い", "夏の夜", "一夜限りの大きな豪華な花を咲かせることがある。",
        "観賞価値あり", "秋", "赤く甘い実（カクタスフルーツ）がなる場合がある。",
        "葉は退化している。\n緑色の多肉質の茎が光合成を行う。", "古くなると木質化する。",
        "春〜秋", "冬", "伸びすぎたら「胴切り」で短くする。\n切った上部は挿し木にできる。", "不可",
        "つきにくい", "カイガラムシ",
        "やや弱い（0度以上推奨）", "強い", "弱い", "非常に強い",
        "過湿に弱いので水はけの良い土壌必須。"
    ],
    "ヒマラヤスギ": [
        "マツ科・ヒマラヤスギ属", "常緑", "高木", "20m-30m", "早い", "年50cm以上",
        "世界三大公園木の一つ。\n水平に広がる枝と、垂れ下がる枝先が優美。\n非常に大きくなるため、広いスペースが必要。",
        "雄大な樹形と銀緑色の葉。\n松ぼっくりは「シダーローズ」としてリース飾りに人気。",
        "観賞価値が低い", "10月-11月", "目立たない。",
        "観賞価値が高い", "翌年の10月-11月", "バラの花のような形の球果（シダーローズ）。",
        "針状の葉が束状につく。\n銀色がかった緑色が美しい。", "灰褐色で鱗片状に剥がれる。",
        "4月-5月、10月-11月", "真夏・真冬", "大きくなりすぎるため、芯止めや透かし剪定で抑制する。\n刈り込みも可能だが自然樹形が美しい。", "可",
        "普通程度", "マツカレハ（毛虫）",
        "強い", "強い", "普通程度", "強い",
        "根が浅く、巨木になると倒木の恐れがある。"
    ],
    "ブルーアイス": [
        "ヒノキ科・ホソイトスギ属", "常緑", "高木", "5m-10m", "非常に早い", "年60cm以上",
        "アリゾナイトスギの園芸品種。\nもっとも青みが強いコニファーの一つ。\n香りが非常に良く、クリスマスの装飾に使われる。",
        "雪をかぶったようなシルバーブルーの葉色。\n爽やかな森林の香り。",
        "観賞価値が低い", "春", "目立たない。",
        "観賞価値あり", "秋", "白粉を帯びた球果。",
        "柔らかい鱗葉で、独特の銀白色。\n触っても痛くない。", "赤褐色で剥がれやすい。",
        "3月-6月、9月-10月", "真夏・真冬", "成長が早いため、こまめな剪定と芯止めが必要。\n枝が柔らかく枝垂れやすい。", "可",
        "つきにくい", "特になし",
        "強い", "普通程度（蒸れに弱い）", "普通程度", "強い",
        "根が浅く、成長が早いため、台風などで非常に倒れやすい。支柱必須。"
    ],
    "ブルーヘブン": [
        "ヒノキ科・ビャクシン属", "常緑", "中木", "3m-5m", "普通程度", "年30-40cm程度",
        "コロラドビャクシンの園芸品種。\n整った円錐形に育つ。\n青緑色の葉が一年中美しい。",
        "スリムな樹形で場所をとりにくい。\nコニファーの中では比較的病害虫に強い。",
        "観賞価値が低い", "4月", "目立たない。",
        "観賞価値実", "秋", "白粉を帯びた青黒い実。",
        "シャープな鱗葉で、青みがかった銀緑色。", "赤褐色。",
        "3月-4月", "真夏・真冬", "自然に形が整うが、刈り込みや透かし剪定で維持する。\n鉄サビ病対策でナシ亜科の近くには植えない。", "可",
        "普通程度", "赤星病（ナシなどの果樹に感染させる）",
        "強い", "普通程度", "普通程度", "普通程度",
        "梨園の近くには植栽禁止の条例がある地域も。"
    ],
    "ホンコンエンシス": [
        "ミズキ科・サンシュユ属（ヤマボウシ亜属）", "常緑", "中木", "3m-5m", "普通程度", "年30-50cm程度",
        "常緑ヤマボウシの代表的な品種。\n一年中葉があり、花も実も楽しめる。\n従来のヤマボウシより花付きが良い。",
        "またたく間にシンボルツリーの定番になった。\n花・実・紅葉・常緑と観賞期間が長い。",
        "観賞価値が高い", "5月-6月", "白〜クリーム色の4枚の総苞片（花びら）が木を覆う。",
        "観賞価値あり・食用可", "9月-10月", "赤く熟す集合果。甘くて食べられる。",
        "厚く光沢のある濃い緑色。\n冬は寒さで赤紫色に紅葉する（落葉はしない）。", "比較的なめらか。",
        "花後（6月-7月）、冬（2月-3月）", "真夏", "自然樹形が美しいため、徒長枝や込み合った枝を抜く程度。\n刈り込みは避ける。", "非推奨",
        "普通程度", "うどんこ病、すす病",
        "普通程度（-5度程度）", "強い", "普通程度", "普通程度",
        "寒冷地では落葉することがある。"
    ],
    "モミノキ": [
        "マツ科・モミ属", "常緑", "高木", "20m-30m", "早い", "年40-60cm程度",
        "日本特産の常緑針葉樹。\nクリスマスツリーの「本物」の木。\n成長すると円錐形の雄大な姿になる。",
        "整った円錐形の樹形。\n神聖な雰囲気があり、記念樹にも使われる。",
        "観賞価値が低い", "5月", "目立たない。",
        "観賞価値あり", "10月", "円筒形の大きな松ぼっくりが直立してつく。",
        "扁平な針状の葉で、先は二股に分かれ痛くない。\n裏に白い気孔線がある。", "灰褐色で、古くなると鱗片状になる。",
        "11月-2月、6月-7月", "真夏", "大きくなるため芯止めが必要。\n枝の配置バランスを見ながら透かし剪定を行う。", "不可",
        "普通程度", "マツクイムシ、テッポウムシ",
        "強い", "弱い（暑さと大気汚染に弱い）", "強い（耐陰性あり）", "普通程度",
        "西日を嫌う。都市部の環境にはあまり適さない。"
    ],
    "ユッカ・デスメティアーナ": [
        "キジカクシ科・イトラン属", "常緑", "低木", "1m-2m", "遅い", "年10-20cm程度",
        "メキシコ原産のユッカの一種。\n葉が柔らかく、先端が垂れ下がる。\n寒さに当たると葉が紫色に紅葉するのが最大の特徴。",
        "冬の紅葉（パープル）が非常に美しい。\nモダンでエレガントな雰囲気。",
        "観賞価値あり", "夏", "白いスズランのような花を房状に咲かせる。",
        "なし", "-", "特になし",
        "柔らかく、縁に細かい鋸歯がある。\n夏は青緑、冬は紫褐色。", "成長すると太い幹が立ち上がる。",
        "春・秋", "真夏・真冬", "枯れた下葉を切り取る。\n大きくなりすぎたら切り戻して挿し木更新。", "不可",
        "つきにくい", "特になし",
        "普通程度（-5度程度）", "強い", "普通程度", "強い",
        "冬の寒さにあてないと綺麗に紅葉しない。"
    ],
    "ユッカ・ロストラータ": [
        "キジカクシ科・イトラン属", "常緑", "中木", "2m-4m", "非常に遅い", "年数cm-10cm程度",
        "シルバーブルーの細い葉が放射状（ボール状）に広がる。\n幹には枯れた葉がスカートのように残る。\n非常に耐寒性が強く、ドライガーデンの最高級品種。",
        "圧倒的な存在感と美しさ。\nシルバーブルーの葉色が洗練された印象。",
        "観賞価値あり", "初夏", "白い花茎を伸ばし、クリーム色の花を咲かせる（古株のみ）。",
        "なし", "-", "特になし",
        "青白い粉を吹いたような細長い葉。\n先端は鋭く尖っている。", "繊維状の毛に覆われた太い幹。",
        "春・秋", "真夏・真冬", "枯れた下葉を幹に残すか、切り取って模様を見せるかで好みが分かれる。", "不可",
        "つきにくい", "特になし",
        "非常に強い（-10度以下）", "非常に強い", "普通程度", "非常に強い",
        "成長が遅く高価だが、非常に丈夫で寿命が長い。"
    ],
    "ヨーロッパゴールド": [
        "ヒノキ科・クロベ属", "常緑", "中木", "4m-6m", "普通程度", "年30cm程度",
        "ニオイヒバの園芸品種。\n春から夏は黄金色の葉が美しく、冬はオレンジがかった褐色になる。\n比較的成長が穏やかで扱いやすい。",
        "発色の良い黄金色の葉が庭を明るくする。\n香りもよい。",
        "観賞価値が低い", "4月", "目立たない。",
        "観賞価値が低い", "10月", "小さな球果。",
        "平たい鱗葉。\n日当たりの良い場所ほど黄金色が鮮やかになる。", "赤褐色。",
        "3月、6月、9月", "真夏・真冬", "自然樹形を楽しむが、軽い刈り込みで整えることも可能。\n芯止めで高さを抑える。", "可",
        "普通程度", "ハダニ、カイガラムシ",
        "強い", "普通程度（蒸れに弱い）", "普通程度", "普通程度",
        "日陰だと色が緑に戻ってしまう。"
    ],
    "ワシントンヤシ": [
        "ヤシ科・ワシントンヤシ属", "常緑", "高木", "10m-20m", "早い", "年50cm-1m程度",
        "北米原産の大型ヤシ。\n空に向かって真っ直ぐ伸びる幹と扇形の葉。\nカリフォルニアスタイルの庭に欠かせない。",
        "リゾート感あふれる景観を作る。\n枯れた葉が垂れ下がり「スカート」を作るのが特徴。",
        "観賞価値あり", "6月-8月", "クリーム色の小花が房状に咲く。",
        "観賞価値低い", "秋", "黒っぽい小さな実。",
        "巨大な手のひら状（扇状）の葉。\n葉柄に鋭いトゲがある。", "滑らかではなく、葉柄の跡が残ることがある。",
        "5月-9月", "冬", "枯れた下葉を切り落とす。\n高所作業になるため専門業者への依頼が必要。", "不可",
        "つきにくい", "特になし",
        "普通程度（-5度程度）", "強い", "弱い", "強い",
        "非常に大きくなるため、一般家庭の庭植えにはスペースの検討が必要。"
    ]
}

# Append new data to dataframe
added_count = 0
for name, data in new_data.items():
    if name not in df.index:
        df.loc[name] = data + [""] * (len(df.columns) - len(data)) # Fill missing columns if any
        added_count += 1
        print(f"Added: {name}")
    else:
        # If it exists (e.g. タラノキ, ニオイヒバ), skip or overwrite?
        # User asked to "Add data for missing species". 
        # If 'タラノキ2' refers to 'タラノキ2' key, it is NOT in df.index yet.
        # So "タラノキ2" will be added.
        print(f"Skipped (Already exists): {name}")

# Save
if added_count > 0:
    df.to_csv(CSV_PATH, encoding='utf-8-sig')
    print(f"\nSuccessfully added {added_count} species to {CSV_PATH}")
else:
    print("\nNo new species added.")
